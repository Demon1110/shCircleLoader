/*!
 * SunHater Circle Loader v0.1 (2014-01-12)
 * jQuery plugin
 * Copyright (c) 2014 Pavel Tzonkov <sunhater@sunhater.com>
 * Dual licensed under the MIT and GPL licenses.
 * http://opensource.org/licenses/MIT
 * http://www.gnu.org/licenses/gpl.html
 */
(function(a){a.fn.shCircleLoader=function(j){var h="shcl";if(j==="destroy"){a(this).find("div."+h).detach();return}var b=1,c={namespace:h,radius:"auto",dotsRadius:"auto",color:"auto",dots:12,duration:1,clockwise:true,externalCss:false,keyframes:"0%{{prefix}transform:scale(1)}80%{{prefix}transform:scale(.3)}100%{{prefix}transform:scale(1)}",uaPrefixes:["o","ms","webkit","moz",""]};a.extend(c,j);var g=c.namespace,d=c.externalCss;while(a("#"+g+b).get(0)){b++}var f=function(o){var m,k="",n=c.uaPrefixes;for(var l=0;l<n.length;l++){m=n[l].length?("-"+n[l]+"-"):"";k+=o.replace(/\{prefix\}/g,m)}return k},e=function(o,n){var k={};if(!o.substr){a.each(o,function(s,r){a.extend(k,e(s,r))})}else{var l,m,q=c.uaPrefixes;for(var l=0;l<q.length;l++){m=q[l].length?("-"+q[l]+"-"):"";k[m+o]=n}}return k},i=function(k){return k.replace(/(.*)px$/i,"$1")};if(!d){a(a("head").get(0)?"head":"body").append('<style id="'+g+b+'" type="text/css">'+f("@{prefix}keyframes "+g+b+"_bounce{"+c.keyframes+"}")+"</style>")}a(this).each(function(){var k,n,p,l,u,w,v,q,o,t,s={},m=a(this);m.html('<div class="'+g+((g!=h)?(" "+h):"")+'"></div>');if(d){m=m.find("div")}w=m.innerWidth()-i(m.css("padding-left"))-i(m.css("padding-right"));v=m.innerHeight()-i(m.css("padding-top"))-i(m.css("padding-bottom"));k=(c.radius=="auto")?((w<v)?(w/2):(v/2)):c.radius;if(!d){k--;if(c.dotsRadius=="auto"){n=Math.abs(Math.sin(Math.PI/(1*c.dots)))*k;n=(n*k)/(n+k)-1}else{n=c.dotsRadius}m=m.find("div");p=Math.ceil(k*2);t={position:"relative",width:p+"px",height:p+"px"};if(p<w){t.marginLeft=Math.round((w-p)/2)}if(p<v){t.marginTop=Math.round((v-p)/2)}m.css(t);p=Math.ceil(n*2)+"px";s={position:"absolute",width:p,height:p,background:(c.color=="auto")?m.css("color"):c.color};a.extend(s,e({"border-radius":Math.ceil(n)+"px","animation-name":g+b+"_bounce","animation-duration":c.duration+"s","animation-iteration-count":"infinite","animation-direction":"linear"}))}for(p=0;p<c.dots;p++){m.append("<div></div>");if(d&&(typeof n==="undefined")){n=(i(m.find("div").css("width"))/2)}l=m.find("div").last();q=(c.duration/c.dots)*p;u=(2*Math.PI*p)/c.dots;o=k-n;w=o*Math.sin(u);v=o*Math.cos(u);if(c.clockwise){v=-v}t={left:Math.round(w+o)+"px",top:Math.round(v+o)+"px"};if(q){a.extend(t,e("animation-delay",q+"s"))}a.extend(t,s);l.css(t)}})}})(jQuery);