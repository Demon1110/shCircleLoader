/*!
 * SunHater Circle Loader v0.1 (2014-01-12)
 * jQuery plugin
 * Copyright (c) 2014 Pavel Tzonkov <sunhater@sunhater.com>
 * Dual licensed under the MIT and GPL licenses.
 * http://opensource.org/licenses/MIT
 * http://www.gnu.org/licenses/gpl.html
 */
(function(a){a.fn.shCircleLoader=function(d){var b="shCircleLoader";if(d==="destroy"){a(this).find("div."+b).detach();return}var i=1,h={namespace:b,radius:"auto",dotsRadius:"auto",color:"auto",dots:12,duration:1,clockwise:true,externalCss:false,keyframes:"0%{{prefix}transform:scale(1)}80%{{prefix}transform:scale(.3)}100%{{prefix}transform:scale(1)}",uaPrefixes:["o","ms","webkit","moz",""]};a.extend(h,d);var e=h.namespace;while(a("#"+e+i).get(0)){i++}var c=function(n){var l,j="",m=h.uaPrefixes;for(var k=0;k<m.length;k++){l=m[k].length?("-"+m[k]+"-"):"";j+=n.replace(/\{prefix\}/g,l)}return j},g=function(n,m){var j={};if(!n.substr){a.each(n,function(r,q){a.extend(j,g(r,q))})}else{var k,l,o=h.uaPrefixes;for(var k=0;k<o.length;k++){l=o[k].length?("-"+o[k]+"-"):"";j[l+n]=m}}return j},f=function(j){return j.replace(/(.*)px$/i,"$1")};if(!h.externalCss){a(a("head").get(0)?"head":"body").append('<style id="'+e+i+'" type="text/css">'+c("@{prefix}keyframes "+e+i+"_bounce{"+h.keyframes+"}")+"</style>")}a(this).each(function(){var j,m,o,k,t,v,u,p,n,s,q={},l=a(this);v=l.innerWidth()-f(l.css("padding-left"))-f(l.css("padding-right"));u=l.innerHeight()-f(l.css("padding-top"))-f(l.css("padding-bottom"));j=(h.radius=="auto")?((v<u)?(v/2):(u/2))-1:h.radius;if(h.dotsRadius=="auto"){m=Math.abs(Math.sin(Math.PI/(1*h.dots)))*j;m=(m*j)/(m+j)-1}else{m=h.dotsRadius}l.html('<div class="'+((e!=b)?(b+" "):"")+e+'"></div>');l=l.find("div");if(!h.externalCss){o=Math.ceil(j*2);s={position:"relative",width:o+"px",height:o+"px"};if(o<v){s.marginLeft=Math.round((v-o)/2)}if(o<u){s.marginTop=Math.round((u-o)/2)}l.css(s);o=Math.ceil(m*2)+"px";q={position:"absolute",width:o,height:o,background:(h.color=="auto")?l.css("color"):h.color};a.extend(q,g({"border-radius":Math.ceil(m)+"px","animation-name":e+i+"_bounce","animation-duration":h.duration+"s","animation-iteration-count":"infinite","animation-direction":"linear"}))}for(o=0;o<h.dots;o++){l.append("<div></div>");k=l.find("div").last();p=(h.duration/h.dots)*o;t=(2*Math.PI*o)/h.dots;n=(j-m);v=n*Math.sin(t);u=n*Math.cos(t);if(h.clockwise){u=-u}s={left:Math.round(v+n)+"px",top:Math.round(u+n)+"px"};if(p){a.extend(s,g("animation-delay",p+"s"))}a.extend(s,q);k.css(s)}})}})(jQuery);